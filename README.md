# Fixed Image Optimizer

## Описание

**Fixed Image Optimizer** - это плагин для WordPress, предназначенный для оптимизации изображений и конвертации их в формат WebP. Плагин предоставляет простой и удобный способ улучшить производительность вашего сайта, уменьшив размер изображений, при этом сохраняя их качество. Он интегрируется во все разделы WordPress, связанные с изображениями, включая медиа-библиотеку и страницы редактирования вложений.

## Возможности

*   **Автоматическая оптимизация изображений**: Плагин оптимизирует изображения, уменьшая их размер для более быстрой загрузки.
*   **Конвертация в WebP**: Плагин может автоматически конвертировать изображения в формат WebP, который обеспечивает лучшее сжатие и качество по сравнению с JPEG и PNG.
*   **Настройка качества сжатия**: Пользователь может настроить уровень качества сжатия изображений с помощью удобного слайдера. Это позволяет найти оптимальный баланс между размером файла и визуальным качеством.
*   **Интеграция с медиа-библиотекой**: Плагин добавляет интерфейс оптимизации непосредственно в модальное окно медиа-библиотеки WordPress, что позволяет оптимизировать изображения быстро и удобно.
*   **Поддержка различных форматов**: Поддерживает оптимизацию изображений в форматах JPEG, PNG и WebP.
*   **Простая установка и использование**: Плагин легко устанавливается и настраивается, не требуя специальных навыков.

## Установка

1.  **Скачайте плагин**: Скачайте файлы плагина (ZIP-архив).
2.  **Загрузите в WordPress**: В панели управления WordPress перейдите в раздел "Плагины" -> "Добавить новый".
3.  **Загрузите плагин**: Нажмите кнопку "Загрузить плагин" и выберите скачанный ZIP-архив.
4.  **Активируйте плагин**: После установки активируйте плагин через раздел "Плагины".
5.  **Проверка файлов**: При активации плагин автоматически проверит наличие необходимых файлов стилей (CSS) и скриптов (JS) и создаст их, если они отсутствуют.

## Использование

### Оптимизация изображений через медиа-библиотеку

1.  **Перейдите в медиа-библиотеку**: В панели управления WordPress выберите "Медиа" -> "Библиотека".
2.  **Выберите изображение**: Кликните на изображение, которое хотите оптимизировать. Откроется модальное окно с деталями изображения.
3.  **Найдите раздел "Оптимизация изображения"**: В правой части модального окна вы увидите новый раздел "Оптимизация изображения".
4.  **Настройте параметры оптимизации**:
    *   **Формат**: Выберите формат, в который хотите конвертировать изображение: "WebP формат" или "Оригинальный формат".
    *   **Качество**: Используйте слайдер для настройки качества сжатия. Чем выше значение, тем лучше качество изображения, но больше размер файла.
5.  **Нажмите кнопку "Оптимизировать"**: После выбора настроек нажмите кнопку "Оптимизировать". Плагин начнет процесс оптимизации и отобразит результат в этом же разделе.
6. **Обновите страницу**: После успешной оптимизации появится кнопка "Обновить страницу" - нажмите на нее, чтобы обновить превью изображения и отобразить оптимизированную версию.

### Оптимизация изображений на странице редактирования вложения

1.  **Перейдите на страницу редактирования вложения**: Найдите нужное изображение в медиа-библиотеке и кликните на ссылку "Редактировать".
2.  **Найдите раздел "Оптимизация изображения"**: Прокрутите страницу вниз, чтобы найти раздел "Оптимизация изображения".
3.  **Настройте параметры оптимизации**: Аналогично оптимизации через медиа-библиотеку, выберите формат и качество сжатия.
4.  **Нажмите кнопку "Оптимизировать"**: Нажмите кнопку "Оптимизировать", чтобы начать процесс. Результат будет отображен в этом же разделе.

## Технические детали

### Структура плагина

Плагин состоит из следующих основных файлов:

*   `fixed-image-optimizer.php` - Основной файл плагина, содержащий логику инициализации, хуки и обработчики AJAX-запросов.
*   `fixed-style.css` - Файл стилей плагина, содержащий CSS-правила для элементов интерфейса.
*   `fixed-script.js` - Файл скриптов плагина, содержащий JavaScript-код для обработки событий и взаимодействия с AJAX.

### Хуки WordPress

Плагин использует следующие хуки WordPress:

*   `admin_enqueue_scripts` - Для подключения CSS и JS файлов в административной панели.
*   `media_meta` - Для добавления интерфейса оптимизации на страницу информации о вложении.
*   `admin_footer` - Для добавления JS-кода в модальное окно медиа-библиотеки.
*   `wp_ajax_fixed_optimize_image` - Для обработки AJAX-запросов на оптимизацию изображений.
*   `register_activation_hook` - Для создания необходимых файлов при активации плагина.
*   `admin_init` - Для проверки наличия необходимых файлов при инициализации.

### AJAX обработка

Плагин использует AJAX для отправки запросов на оптимизацию изображений без перезагрузки страницы. Это обеспечивает более удобный и быстрый процесс оптимизации.

### Поддержка WebP

Плагин поддерживает конвертацию изображений в формат WebP, который позволяет значительно уменьшить размер файлов без потери качества.

### Создание файлов стилей и скриптов

При активации плагина автоматически создаются файлы стилей (`fixed-style.css`) и скриптов (`fixed-script.js`), если они отсутствуют. Эти файлы содержат CSS-правила и JavaScript-код, необходимые для работы интерфейса оптимизации.

## Требования

*   **WordPress**: 5.0 или выше
*   **PHP**: 7.2 или выше
*   Поддержка GD или Imagick на сервере (для обработки изображений). Обычно GD устанавливается по умолчанию.

## FAQ

*   **Почему я не вижу раздел "Оптимизация изображения"?**
    *   Убедитесь, что плагин активирован.
    *   Убедитесь, что вы просматриваете страницу редактирования изображения (медиа-файл) или модальное окно медиа-библиотеки.
    *   Проверьте, что ваш сервер соответствует минимальным требованиям (PHP 7.2+).
*   **Почему после оптимизации не меняется превью изображения?**
    *   Попробуйте очистить кеш браузера.
    *   Нажмите кнопку "Обновить страницу", которая появляется после успешной оптимизации.

## История изменений

*   **Версия 1.1**: Добавлена поддержка формата WebP и улучшена производительность.
*   **Версия 1.0**: Первая версия плагина с базовыми функциями оптимизации изображений.
